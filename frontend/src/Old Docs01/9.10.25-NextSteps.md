# TributeStream Funeral Director Registration System - Next Steps
**Date:** September 10, 2025  
**Status:** Requirements Analysis & Planning

## Current System Analysis

### Existing `/register/funeral-director` Route
- **Purpose:** Family memorial registration form used during 1-on-1 sessions
- **User:** Funeral director fills this out WITH the family present
- **Data Collected:** Memorial details, family contact info, service information
- **Current State:** Functional but requires manual input each time

## Required New System: Funeral Director Onboarding

### 1. **New Funeral Director Registration Page**
**Route:** `/register/funeral-home` or `/funeral-director/apply`

**Purpose:** Allow new funeral directors to register their funeral home in the TributeStream system

**Data Collection:**
- **Funeral Home Information:**
  - Company/Funeral Home Name
  - Business License Number
  - Physical Address
  - Phone Number
  - Website (optional)
  - Years in Business

- **Primary Contact Information:**
  - Director Name
  - Title/Position
  - Email Address
  - Direct Phone Number
  - Professional License Number

- **Business Verification Documents:**
  - Business License Upload
  - Funeral Director License Upload
  - Insurance Certificate Upload
  - Professional References (optional)

- **Service Area:**
  - Geographic coverage area
  - Types of services offered
  - Pricing tier preference

**Status:** Pending admin approval after submission

### 2. **Admin Approval Workflow**
**Integration:** Existing `/admin` dashboard

**Admin Actions:**
- Review funeral director applications
- Verify uploaded documents
- Approve or reject applications with reasons
- Send notification emails to applicants

**Approval Results:**
- **Approved:** Funeral director gains access to prepopulated forms
- **Rejected:** Email with rejection reason and reapplication process

### 3. **Enhanced Family Registration Experience**

#### **For Approved Funeral Directors:**
**Route:** `/register/funeral-director` (existing, but enhanced)

**Prepopulation Logic:**
- Detect logged-in funeral director
- Auto-fill funeral home details:
  - Funeral home name
  - Director name and contact info
  - Business address
  - Standard service options

**Editable Fields:**
- All prepopulated fields remain editable
- Allows different directors from same funeral home
- Supports custom service modifications
- Family-specific memorial details

#### **Auto-Save Functionality:**
**Technology:** Browser cookies + localStorage

**Implementation:**
- Save form data every 30 seconds
- Store in encrypted cookies for session persistence
- Restore data when returning to form
- Clear saved data after successful submission

**Data Persistence:**
- Survives browser refresh
- Survives browser close/reopen
- Expires after 7 days or successful submission
- Includes timestamp for data freshness

## Technical Implementation Plan

### Phase 1: Funeral Director Registration
1. Create `/register/funeral-home/+page.svelte`
2. Create `/register/funeral-home/+page.server.ts`
3. Add document upload functionality
4. Create `funeral_directors` Firestore collection
5. Update admin dashboard to show pending applications

### Phase 2: Admin Approval System
1. Enhance `/admin` dashboard with approval interface
2. Create approval/rejection API endpoints
3. Implement email notification system
4. Add document viewing capabilities for admins

### Phase 3: Enhanced Family Registration
1. Modify existing `/register/funeral-director` route
2. Add funeral director authentication detection
3. Implement prepopulation logic from approved funeral director data
4. Maintain all existing functionality while adding enhancements

### Phase 4: Auto-Save Implementation
1. Create auto-save utility functions
2. Implement cookie-based form persistence
3. Add form restoration logic
4. Include visual indicators for saved/unsaved state

## User Flow Examples

### New Funeral Director Onboarding:
1. Funeral director visits `/register/funeral-home`
2. Fills out comprehensive application form
3. Uploads required business documents
4. Submits application (status: "pending")
5. Admin reviews and approves application
6. Funeral director receives approval email
7. Can now use prepopulated family registration forms

### Family Memorial Creation (Enhanced):
1. Approved funeral director logs in
2. Navigates to `/register/funeral-director`
3. Form loads with funeral home details prepopulated
4. Director edits any details as needed for specific case
5. Fills out family and memorial-specific information
6. Form auto-saves progress every 30 seconds
7. Can leave and return without losing data
8. Submits completed memorial registration

## Benefits

### For Funeral Directors:
- Streamlined onboarding process
- Reduced data entry for each family
- Professional verification and credibility
- Consistent branding across memorials

### For Families:
- Faster memorial setup process
- Reduced errors from manual data entry
- Professional, verified funeral home information
- Seamless experience during difficult times

### For TributeStream:
- Quality control through admin approval
- Verified business partnerships
- Reduced support requests
- Professional network growth

## Database Schema Updates

### New Collection: `funeral_directors`
```typescript
{
  id: string,
  status: 'pending' | 'approved' | 'rejected',
  companyName: string,
  businessLicense: string,
  contactPerson: string,
  email: string,
  phone: string,
  address: object,
  licenseNumber: string,
  documents: {
    businessLicense: string, // Storage URL
    funeralLicense: string,  // Storage URL
    insurance: string        // Storage URL
  },
  serviceArea: string[],
  createdAt: Timestamp,
  approvedAt?: Timestamp,
  approvedBy?: string, // Admin UID
  rejectionReason?: string
}
```

### Enhanced Collection: `memorials`
```typescript
{
  // Existing fields...
  funeralDirectorId?: string, // Reference to approved funeral director
  funeralDirectorInfo?: {     // Snapshot of director info at creation
    companyName: string,
    contactPerson: string,
    phone: string,
    // etc.
  }
}
```

## Next Implementation Steps

1. **Create funeral director registration page** - New route and form
2. **Enhance admin dashboard** - Add approval workflow
3. **Implement prepopulation logic** - Modify existing family registration
4. **Add auto-save functionality** - Cookie-based form persistence
5. **Testing and refinement** - End-to-end workflow validation

This system will create a professional onboarding experience for funeral directors while significantly improving the family memorial creation process through automation and data persistence.
